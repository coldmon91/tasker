# 작업 로그 - 2026년 1월 5일

## 수행한 작업

### 1. 프로젝트 초기화 및 환경 설정
- **Tauri + SvelteKit** 기반의 프로젝트 구조 생성 (TypeScript 사용).
- **Tailwind CSS v4** 설치 및 Vite 플러그인(`@tailwindcss/vite`)을 통한 설정 완료.
- **Lucide Svelte** 아이콘 라이브러리 추가.

### 2. 프론트엔드 UI 구현
- **레이아웃**: 사이드바 기반의 애플리케이션 쉘 구현 (`+layout.svelte`).
- **할 일 목록(Task List)**: 할 일 추가, 목록 표시, 상태 토글, 삭제 UI 구현 (`+page.svelte`).
- **캘린더 뷰**: 기본적인 월간 달력 및 오늘 날짜 강조 기능 구현 (`calendar/+page.svelte`).
- **UI 개선**: 
  - 할 일 삭제 아이콘을 `Trash2`로 변경.
  - 메인 콘텐츠 영역에 세로 스크롤(`overflow-y-auto`) 추가.
  - 사이드바 내비게이션에 `Settings` 항목 통합 및 활성화 상태 스타일 적용.

### 3. 백엔드 및 데이터베이스 연동
- **SQLite 통합**: `rusqlite`를 사용하여 로컬 데이터베이스 연동.
- **데이터 영속성**: 할 일(Task) CRUD 기능을 Rust 백엔드에서 구현.
- **상태 관리**: Tauri `AppState`와 `Mutex`를 사용하여 데이터베이스 연결 관리.
- **비동기 안전성**: `Database` 구조체에 `Clone`을 구현하여 비동기 커맨드 실행 시 Mutex Lock 점유 문제 해결.

### 4. 기능 추가
- **할 일 상세 페이지**: Task 카드 클릭 시 상세 페이지(`/task/[id]`)에서 제목, 우선순위, 카테고리, 마감일 수정 기능 구현.
- **설정 페이지(`settings/+page.svelte`)**: Tasker 계정, Google 연동, Apple 연동을 관리하는 통합 설정 허브 구현.

### 5. Google 계정 및 Tasks 연동
- **통합 Google 로그인**: 
  - 기존 Tasks 전용 연동에서 Google 계정 통합 로그인 방식으로 고도화.
  - OAuth Scopes 확장 (Tasks, Calendar, Email, Profile).
  - 연동 시 사용자 프로필(이메일 등) 정보를 가져와 UI에 표시하는 기능 추가.
- **OAuth2 Flow**: Authorization Code Flow 구현 및 브라우저를 통한 인증 연동.
- **환경변수 기반 관리**: 
  - `GOOGLE_CLIENT_ID` 및 `GOOGLE_CLIENT_SECRET`을 UI 입력 대신 `.env` 파일(환경변수)에서 관리하도록 변경하여 보안 및 편의성 강화.
  - `dotenv` crate 추가 및 백엔드 초기화 로직 반영.

### 6. 버그 수정 및 최적화
- **500 Internal Error 수정**: SvelteKit SSR 관련 설정 확인 및 프론트엔드 오류 수정.
- **Tauri 플러그인 수정**: `@tauri-apps/plugin-opener`의 잘못된 메서드 호출(`open` -> `openUrl`) 수정.
- **컴파일 오류 해결**: `reqwest` 기능(json, form, query) 추가 및 Rust 비동기 커맨드의 `Send` 트레이트 미준수 문제 해결.

### 7. UI/UX 개선
- **할 일 카드 클릭 시 상세 페이지 이동**: 할 일 카드의 전체 영역을 클릭 가능하게 개선하여 상세 설정 페이지로의 접근성을 높임. `stopPropagation`을 사용하여 체크박스와 삭제 버튼 클릭 시 이벤트 전파를 차단함.
- **할 일 드래그 앤 드롭 정렬**: 
  - `tasks` 테이블에 `position` 컬럼 추가 및 백엔드 로직 업데이트 (`get_tasks` 시 `position` 기준 정렬, `add_task` 시 마지막 위치 배정).
  - 프론트엔드에서 HTML5 Drag and Drop API를 사용하여 할 일 카드 순서 변경 기능 구현.
  - 변경된 순서를 데이터베이스에 영구 저장하는 `update_task_order` Tauri 커맨드 추가.

### 8. 드래그 앤 드롭 순서 변경 버그 수정
- **문제 분석**:
  - HTML5 Drag and Drop API가 Tauri 환경에서 제대로 작동하지 않는 문제 발견.
  - `dragstart`와 `dragend` 이벤트는 발생하지만 `dragover`와 `drop` 이벤트가 발생하지 않음.
  - 드래그 핸들이 작아서 다른 카드 위로 이동하기 어려운 UX 문제.
- **해결 방법**:
  - HTML5 Drag and Drop API 대신 **마우스 이벤트 기반 드래그 앤 드롭**으로 재구현.
  - `onmousedown`, `onmouseenter`, `onmouseup` 이벤트를 사용하여 드래그 동작 구현.
  - 버튼 클릭 시 드래그가 시작되지 않도록 `closest('button')` 체크 추가.
  - 카드 전체를 드래그 가능하게 변경하여 사용성 개선.
- **UI 개선**:
  - `GripVertical` 아이콘을 시각적 표시로 유지.
  - `cursor-grab` 및 `active:cursor-grabbing` 스타일 적용.
  - `select-none` 클래스로 드래그 중 텍스트 선택 방지.
  - 드래그 중인 카드와 드롭 타겟 카드의 시각적 피드백 강화.
- **디버깅 로그 추가**:
  - 드래그 동작의 각 단계에서 콘솔 로그 출력.
  - 문제 진단 및 해결을 위한 상세 로그 구현.

### 9. 문서화 구조 개선
- **문서 중앙화**:
  - `CLAUDE.md`와 `GEMINI.md`에 분산되어 있던 프로젝트 아키텍처, 개발 가이드, 패턴 등의 내용을 `PROJECT.md`로 통합.
  - `PROJECT.md`를 단일 진실 공급원(Single Source of Truth)으로 격상.
- **에이전트 가이드 경량화**:
  - `CLAUDE.md`와 `GEMINI.md`는 `PROJECT.md`를 참조하도록 수정하여 중복 제거 및 유지보수성 향상.

## 다음 작업 예정
- Apple Reminders 연동 구현.
- Google Calendar 일정을 캘린더 뷰에 표시 기능.
- 할 일의 상세 정보(메모, 반복 설정 등) 추가 기능 고도화.
- 캘린더 내 드래그 앤 드롭 일정 이동 기능 구현.